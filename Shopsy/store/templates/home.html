{% extends 'base.html'%} {% load static %} {% block content %}
<!-- Top Navbar -->
<header>
  <div class="logo">
    <img src="{% static 'store/logo.jpg' %}" alt="Shopsy_logo" />
  </div>
  <form method="get" action="{% url 'search'%}">
    <input type="text" name="q" placeholder="Search Products...." />
  </form>
</header>
<div class="layout">
  <!-- main content area -->
  <main class="main-content">
    <div class="hero-banner">
      <div class="slider">
        <div class="hero hero1">
          <h1>Welcome to Shopsy</h1>
          <p>Discover the latest trends and shop your favourites.</p>
          <button>Shop Now</button>
        </div>
        <div class="hero hero2">
          <h1>Big Summer Sale</h1>
          <p>Up to 50% Off on all fashion items</p>
          <button>Shop Now</button>
        </div>
        <div class="hero hero3">
          <h1>New Arrivals</h1>
          <p>Trendy fashion just for you</p>
          <button>Discover</button>
        </div>
        <div class="hero hero4">
          <h1>Latest Collections</h1>
          <p>We are here to match your asthetics</p>
          <button>Explore more</button>
        </div>
      </div>
    </div>
  </main>
</div>
<!-- Category  Section -->
<section class="category">
  <h1>Shop by Category</h1>
  <div class="category-grid">
    <div class="category-cart">
      <img src="{% static 'store/download.jpg'%}" />
      <a href="{% url 'category' 'Women'%}"><h3>Women</h3></a>
    </div>
    <div class="category-cart">
      <img src="{% static 'store/men_cart.jpg'%}" />
      <a href="{% url 'category' 'Men'%}"><h3>Men</h3></a>
    </div>
    <div class="category-cart">
      <img src="{% static 'store/kids_cart.jpg'%}" />
      <a href="{% url 'category' 'Kids'%}"><h3>Kids</h3></a>
    </div>
    <div class="category-cart">
      <img src="{% static 'store/footwear_cart.jpg'%}" />
      <a href="{% url 'category' 'Footwear'%}"><h3>Foot-wears</h3></a>
    </div>
    <div class="category-cart">
      <img src="{% static 'store/aceessoris cart.jpg'%}" />
      <a href="{% url 'category' 'Acessories'%}"><h3>Accessories</h3></a>
    </div>
    <div class="category-cart">
      <img src="{% static 'store/makeup_cart.jpg'%}" />
      <a href="{% url 'category' 'Makeup'%}"><h3>Make-up</h3></a>
    </div>
    <!-- <div class="category-cart">
                <img src="{% static 'store/'%}">
                <h3>Skincare</h3>
            </div> -->
  </div>
</section>
<!-- Products -->
<section class="products">
  <h1>Some of Our Latest Products</h1>

  <div class="product-grid">
    {% for product in products %}
    <div class="product-cart">
      <img class="product-image" src="{{product.image.url}}" />
      <div class="product-details">
        <h5 class="card-title">{{product.name}}</h5>
        <p class="card-text">Rs.{{product.price}}</p>
        <!-- <p>{{product.description}}</p> -->
        <p>
          Quantity:
            <select class="form-select form-select-sm qty-cart">
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
            </select>
        </p>
        <button>Buy-Now</button>
        <button type="button" value="{{product.id}}" class="add-cart">Add to cart</button>
        <a href="{% url 'product' product.id %}">View Product>></a>
      </div>
    </div>
    {% endfor%}
  </div>
</section>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
  //check if button pressed
  $(document).on("click", ".add-cart", function (e) {
    e.preventDefault();

    let product_id = $(this).val(); // button value
    let product_qty = $(this).closest(".product-details").find(".qty-cart").val(); // dropdown near button


    $.ajax({
      type: "POST",
      url: "{% url 'cart_add' %}",
      data: {
            product_id: product_id,
            product_qty: product_qty,
            csrfmiddlewaretoken: "{{csrf_token}}",
            action: "post",
      },

      success: function (json) {
          //console.log(json);, update it live
          document.getElementById("cart_quantity").textContent = json.qty;
      },

      error: function (xhr, errmsg, err) {
          console.error("Error adding to cart:", errmsg);
      },
    });
  });
</script>
{% endblock %}
